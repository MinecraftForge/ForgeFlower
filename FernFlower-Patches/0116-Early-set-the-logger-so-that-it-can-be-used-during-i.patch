From 0d79d5adcf27840fcb93094b62bb04601b6eafd0 Mon Sep 17 00:00:00 2001
From: cpw <cpw@weeksfamily.ca>
Date: Sun, 8 Nov 2015 16:12:19 -0500
Subject: [PATCH 116/122] Early set the logger so that it can be used during
 init context without NPEs.

---
 src/org/jetbrains/java/decompiler/main/DecompilerContext.java | 3 ++-
 src/org/jetbrains/java/decompiler/main/Fernflower.java        | 1 +
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/org/jetbrains/java/decompiler/main/DecompilerContext.java b/src/org/jetbrains/java/decompiler/main/DecompilerContext.java
index d66145a..22ab9e0 100644
--- a/src/org/jetbrains/java/decompiler/main/DecompilerContext.java
+++ b/src/org/jetbrains/java/decompiler/main/DecompilerContext.java
@@ -68,7 +68,8 @@ public class DecompilerContext {
       try {
         currentContext.get().renamerFactory = Class.forName((String) DecompilerContext.getProperty(RENAMER_FACTORY)).asSubclass(IVariableNamingFactory.class).newInstance();
       } catch (Exception e) {
-        getLogger().writeMessage("Error loading renamer factory class", e);
+        e.printStackTrace();
+        System.err.println("Error loading renamer factory class");
       }
     }
     if (DecompilerContext.getNamingFactory() == null) {
diff --git a/src/org/jetbrains/java/decompiler/main/Fernflower.java b/src/org/jetbrains/java/decompiler/main/Fernflower.java
index 91e70d3..8319da8 100644
--- a/src/org/jetbrains/java/decompiler/main/Fernflower.java
+++ b/src/org/jetbrains/java/decompiler/main/Fernflower.java
@@ -41,6 +41,7 @@ public class Fernflower implements IDecompiledData {
 
   public Fernflower(IBytecodeProvider provider, IResultSaver saver, Map<String, Object> options, IFernflowerLogger logger) {
     structContext = new StructContext(saver, this, new LazyLoader(provider));
+    DecompilerContext.setLogger(logger);
     DecompilerContext.initContext(options);
     DecompilerContext.setCounterContainer(new CounterContainer());
     DecompilerContext.setLogger(logger);
-- 
2.21.0.windows.1

