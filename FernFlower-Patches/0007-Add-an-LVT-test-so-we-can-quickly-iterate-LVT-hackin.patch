From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: cpw <cpw@weeksfamily.ca>
Date: Sun, 2 Aug 2015 10:43:54 -0400
Subject: [PATCH] Add an LVT test so we can quickly iterate LVT hacking


diff --git a/test/org/jetbrains/java/decompiler/LVTTest.java b/test/org/jetbrains/java/decompiler/LVTTest.java
new file mode 100644
index 0000000000000000000000000000000000000000..2d39827fabef8a71133de494460a0c67f4ae9f8b
--- /dev/null
+++ b/test/org/jetbrains/java/decompiler/LVTTest.java
@@ -0,0 +1,33 @@
+/*
+ * Copyright 2000-2014 JetBrains s.r.o.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ * http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.jetbrains.java.decompiler;
+
+import org.jetbrains.java.decompiler.main.extern.IFernflowerPreferences;
+import org.junit.Test;
+
+import java.util.HashMap;
+import java.util.Map;
+
+public class LVTTest extends SingleClassesTestBase {
+  @Override
+  protected Map<String, Object> getDecompilerOptions() {
+    return new HashMap<String, Object>() {{
+      put(IFernflowerPreferences.USE_DEBUG_LINE_NUMBERS, "1");
+    }};
+  }
+
+  @Test public void testMatch1() { doTest("pkg/TestLVT"); }
+}
diff --git a/testData/classes/pkg/TestLVT.class b/testData/classes/pkg/TestLVT.class
new file mode 100644
index 0000000000000000000000000000000000000000..d8a5829d4f6504567ecf46bf65167047e41cd291
GIT binary patch
literal 1672
zcmZ`(T~k|C6kR9W<bH6mAta&cmsOD_Ei@8su?bQE#ex^8f>CsQID{))ny*Q2I>Woq
zJUPDjqT^Vf^&vRc=@0N1_+OkUu9KS#fglskJs)eYz4ktPpTA%J`2s)=U+D-54A-CR
zWw+d>?-aLmXadm#`BY}hvbvYu*g0@ZzCdKot9t&tz)(6<6wsDxyRL;Hm^Q+Q2wZZ!
zs=MB*?6{3Bxl?upVot3j%SGAn)VjN=`TJf|V8rQjSs;7G_4jML0=Lr6sqam{;Z^qv
zgFBg`fl*pDOSQT?V_-}`59ZQ9qIZxpFy1@JNgXMHu?~65_sZFYMnfJtUemX58K#bF
z0^{dhFSfk$uG_G112=WNdL}V}I2*6wbvk(}%Pn`~8-dCG0D|NdGJ_FVxQYptx;F(9
z{U+U*Gew2CWh0FY<B|2cTV;BtFM<xRcV!n8#T`X4C2%dhGAN@Tcvk_l=Un`60R5IT
zHY@3E0mH8a>ILHIL1zUM_b{vD{@FAhHhs5Z<6S&pZPi*VwL}n*SIa);{rlu}Wre{M
z@Scvj-X)$rwlS|#sn?Z7xoY5j>gkk3?hXrNQNZl2SP35pjGk7)BiY<vlXVMAFjdMv
zQki(9Qnor6MKAC$`$zp*0wFo0s{MTNu&hHeCm=ljuLy*zHLuCOhz7_`5vuwlPHWa>
zg{W24N2kIliigRweRNpw_0mKiR1wYfN$6hOJnirG!N_<4>SDW*O<$It(4yPA)@H5M
zD7nj?YHqvxT-;S^*#o@0PC7!I@jc+EbDiZ^@Eg8;4C6OWLa;chW5B>LM>_!UJHnNT
zS8$0tG#39r>!6>-qHD3(`p|vtS1iTi`EV?mk37fa?PFZY>(6m@d+HBdKgJuWa2u1U
z2#18$#_g2e#&jER<&EF*PReK_|E(qxTGaaK<S%oUWXrLK`ABR*aV(MS!@Qx$rn_W{
zM^Q{BNw%!)J7lIJGf9@zEIF$swK!J3`{CqRMHlE@#wh3NZ5(E#b|<nZ<BBt~>xg23
z=PTUZ#2B`@`!y1fNa6tFIO1FMJ@<dXl}>h!Xa_vQ$8h*nvo+3CvVSIv!+b{YBk_)U
ziLr`xY*0lM56J28BI0bhan2(2JcY;jgqdAn=0D}0fg;iC)S*#BU=g8`z(S`UWwAxv
zQP;x6XVj3S*MO}^wgB}x5nu3Z0@_R1I&SbM9-c7DaIgqQ4fq#})W1z^2w(mOPXBh_

literal 0
HcmV?d00001

diff --git a/testData/results/TestLVT.dec b/testData/results/TestLVT.dec
new file mode 100644
index 0000000000000000000000000000000000000000..b1b7e2e3d96ae555cb0fec2901968fb1b366b2a5
--- /dev/null
+++ b/testData/results/TestLVT.dec
@@ -0,0 +1,29 @@
+package pkg;
+
+import java.util.ArrayList;
+import java.util.HashMap;
+
+public class TestLVT {
+
+
+   public static void method(String a1, String a2) {
+      String scope1 = "scope1";
+      String scope1a = "scope1a";
+      for(int i = 0; i < 10; ++i) {
+         String scope2 = "scope2";
+         String scope2a = "scope2a";
+         ArrayList noise = new ArrayList();
+         String spam = scope1 + scope2 + scope2a + i + noise;
+         System.out.println(spam);
+      }
+      for (long i = 0L; i < 10L; ++i) {
+         String scope2 = "scope2+1";
+         String scope2a = "scope2+1a";
+         HashMap noise = new HashMap();
+         String spam = scope1a + scope2 + scope2a + i + noise;
+         System.out.println(spam);
+      }
+        
+   }
+}
+
diff --git a/testData/src/pkg/TestLVT.java b/testData/src/pkg/TestLVT.java
new file mode 100644
index 0000000000000000000000000000000000000000..05b5228e223eb20be14622126efdb7461c0e1bdf
--- /dev/null
+++ b/testData/src/pkg/TestLVT.java
@@ -0,0 +1,27 @@
+package pkg;
+
+import java.util.ArrayList;
+import java.util.HashMap;
+import java.util.List;
+import java.util.Map;
+
+public class TestLVT {
+    public static void method(String a1, String a2) {
+        String scope1 = "scope1";
+        String scope1a = "scope1a";
+        for (int i=0; i<10; i++) {
+            String scope2 = "scope2";
+            String scope2a = "scope2a";
+            List<Object> noise = new ArrayList<Object>();
+            String spam = scope1 + scope2 + scope2a + i + noise;
+            System.out.println(spam);
+        }
+        for (long i=0; i<10; i++) {
+            String scope2 = "scope2+1";
+            String scope2a = "scope2+1a";
+            Map<Object,Object> noise = new HashMap<Object,Object>();
+            String spam = scope1a + scope2 + scope2a + i + noise;
+            System.out.println(spam);
+        }
+    }
+}
